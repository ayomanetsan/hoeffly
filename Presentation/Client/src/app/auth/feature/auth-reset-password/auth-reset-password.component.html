<div class="container">
  <div class="card">
    <div class="logo">
      <h1>Hoffly</h1>
    </div>

    <h4 *ngIf="!resetSent" class="bigger">Reset your password</h4>

    <ng-container *ngIf="!resetSent">
      <p>Enter your email address and we'll send you instructions to reset your password.</p>

      <form [formGroup]="resetPasswordForm" (ngSubmit)="requestPasswordReset()">
        <div class="form-row">
          <input type="email" id="email" formControlName="email" placeholder="Email" autocomplete="off"
                 [ngClass]="resetPasswordForm.get('email')?.invalid && (resetPasswordForm.get('email')?.dirty || resetPasswordForm.get('email')?.touched) ? 'danger' : ''"/>
          <div
            *ngIf="resetPasswordForm.get('email')?.invalid && (resetPasswordForm.get('email')?.dirty || resetPasswordForm.get('email')?.touched)">
            <div *ngIf="resetPasswordForm.get('email')?.errors?.['required']">
              <p class="smaller">
                Email is required.
              </p>
            </div>
            <div *ngIf="resetPasswordForm.get('email')?.errors?.['email']">
              <p class="smaller">
                Invalid email address.
              </p>
            </div>
          </div>
        </div>

        <div *ngIf="errorMessage" class="error-message">
          <p class="smaller">{{ errorMessage }}</p>
        </div>

        <button class="accent" type="submit" [disabled]="resetPasswordForm.invalid || loading">
          Send Reset Link
          <svg *ngIf="loading" width="16" height="16" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><style>.spinner_P7sC{transform-origin:center;animation:spinner_svv2 .75s infinite linear}@keyframes spinner_svv2{100%{transform:rotate(360deg)}}</style><path d="M10.14,1.16a11,11,0,0,0-9,8.92A1.59,1.59,0,0,0,2.46,12,1.52,1.52,0,0,0,4.11,10.7a8,8,0,0,1,6.66-6.61A1.42,1.42,0,0,0,12,2.69h0A1.57,1.57,0,0,0,10.14,1.16Z" class="spinner_P7sC"/></svg>
        </button>
      </form>
    </ng-container>

    <ng-container *ngIf="resetSent">
      <div class="success-message">
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
          <polyline points="22 4 12 14.01 9 11.01"></polyline>
        </svg>
        <h4>Check your email</h4>
      </div>
      <p>We've sent instructions to reset your password to <strong>{{ sentToEmail }}</strong></p>
      <p class="smaller">If you don't see the email in your inbox, please check your spam folder.</p>
    </ng-container>

    <p>Go back to <a routerLink="/auth/login">sign in.</a></p>
  </div>
</div>
